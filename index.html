<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cryptokit (cryptokit.Cryptokit)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">cryptokit</a> &#x00BB; Cryptokit</nav><header class="odoc-preamble"><h1>Module <code><span>Cryptokit</span></code></h1><p>The Cryptokit library provides a variety of cryptographic primitives that can be used to implement cryptographic protocols in security-sensitive applications.</p><p>The primitives provided include:</p><ul><li>Symmetric-key ciphers: AES, Chacha20, DES, Triple-DES, Blowfish, ARCfour, in ECB, CBC, CFB, OFB and counter modes.</li><li>Authenticated encryption: AES-GCM, Chacha20-Poly1305</li><li>Public-key cryptography: RSA encryption, Diffie-Hellman key agreement.</li><li>Hash functions and MACs: SHA-3, SHA-2, BLAKE2, RIPEMD-160, and MACs based on AES, DES, and SipHash.</li><li>Random number generation.</li><li>Encodings and compression: base 64, hexadecimal, Zlib compression.</li></ul></header><nav class="odoc-toc"><ul><li><a href="#general-purpose-abstract-interfaces">General-purpose abstract interfaces</a></li><li><a href="#utilities:-random-numbers-and-padding-schemes">Utilities: random numbers and padding schemes</a></li><li><a href="#cryptographic-primitives-(simplified-interface)">Cryptographic primitives (simplified interface)</a></li><li><a href="#advanced,-compositional-interface-to-block-ciphers-and-stream-ciphers">Advanced, compositional interface to block ciphers and stream ciphers</a></li><li><a href="#encoding-and-compression-of-data">Encoding and compression of data</a></li><li><a href="#error-reporting">Error reporting</a></li><li><a href="#miscellaneous-utilities">Miscellaneous utilities</a></li></ul></nav><div class="odoc-content"><h2 id="general-purpose-abstract-interfaces"><a href="#general-purpose-abstract-interfaces" class="anchor"></a>General-purpose abstract interfaces</h2><div class="odoc-spec"><div class="spec class-type" id="class-type-transform" class="anchored"><a href="#class-type-transform" class="anchor"></a><code><span><span class="keyword">class</span> <span class="keyword">type</span>  </span><span><a href="class-type-transform/index.html">transform</a></span><span> = <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A <i>transform</i> is an arbitrary mapping from sequences of characters to sequences of characters. Examples of transforms include ciphering, deciphering, compression, decompression, and encoding of binary data as text. Input data to a transform is provided by successive calls to the methods <code>put_substring</code>, <code>put_string</code>, <code>put_char</code> or <code>put_byte</code>. The result of transforming the input data is buffered internally, and can be obtained via the <code>get_string</code>, <code>get_substring</code>, <code>get_char</code> and <code>get_byte</code> methods.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transform_string" class="anchored"><a href="#val-transform_string" class="anchor"></a><code><span><span class="keyword">val</span> transform_string : <span><a href="class-type-transform/index.html">transform</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>transform_string t s</code> runs the string <code>s</code> through the transform <code>t</code> and returns the transformed string. The transform <code>t</code> is wiped before returning, hence can no longer be used for further transformations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transform_channel" class="anchored"><a href="#val-transform_channel" class="anchor"></a><code><span><span class="keyword">val</span> transform_channel : 
  <span><a href="class-type-transform/index.html">transform</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?len:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.in_channel <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.out_channel <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>transform_channel t ic oc</code> reads characters from input channel <code>ic</code>, runs them through the transform <code>t</code>, and writes the transformed data to the output channel <code>oc</code>. If the optional <code>len</code> argument is provided, exactly <code>len</code> characters are read from <code>ic</code> and transformed; <code>End_of_file</code> is raised if <code>ic</code> does not contain at least <code>len</code> characters. If <code>len</code> is not provided, <code>ic</code> is read all the way to end of file. The transform <code>t</code> is wiped before returning, hence can no longer be used for further transformations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-compose" class="anchored"><a href="#val-compose" class="anchor"></a><code><span><span class="keyword">val</span> compose : <span><a href="class-type-transform/index.html">transform</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="class-type-transform/index.html">transform</a> <span class="arrow">&#45;&gt;</span></span> <a href="class-type-transform/index.html">transform</a></span></code></div><div class="spec-doc"><p>Compose two transforms, feeding the output of the first transform to the input of the second transform.</p></div></div><div class="odoc-spec"><div class="spec class-type" id="class-type-hash" class="anchored"><a href="#class-type-hash" class="anchor"></a><code><span><span class="keyword">class</span> <span class="keyword">type</span>  </span><span><a href="class-type-hash/index.html">hash</a></span><span> = <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A <i>hash</i> is a function that maps arbitrarily-long character sequences to small, fixed-size strings.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-hash_string" class="anchored"><a href="#val-hash_string" class="anchor"></a><code><span><span class="keyword">val</span> hash_string : <span><a href="class-type-hash/index.html">hash</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>hash_string h s</code> runs the string <code>s</code> through the hash function <code>h</code> and returns the hash value of <code>s</code>. The hash <code>h</code> is wiped before returning, hence can no longer be used for further hash computations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-hash_channel" class="anchored"><a href="#val-hash_channel" class="anchor"></a><code><span><span class="keyword">val</span> hash_channel : <span><a href="class-type-hash/index.html">hash</a> <span class="arrow">&#45;&gt;</span></span> <span>?len:int <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Stdlib</span>.in_channel <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>hash_channel h ic</code> reads characters from the input channel <code>ic</code>, computes their hash value and returns it. If the optional <code>len</code> argument is provided, exactly <code>len</code> characters are read from <code>ic</code> and hashed; <code>End_of_file</code> is raised if <code>ic</code> does not contain at least <code>len</code> characters. If <code>len</code> is not provided, <code>ic</code> is read all the way to end of file. The hash <code>h</code> is wiped before returning, hence can no longer be used for further hash computations.</p></div></div><p>An <i>authenticated transform</i> maps sequences of bytes to sequences of bytes, just like a transform, but also builds a message authentication tag for the transformed data. The tag is returned by the <code>finish</code> method. Authenticated transforms are used for authenticated encryption and decryption.</p><div class="odoc-spec"><div class="spec class-type" id="class-type-authenticated_transform" class="anchored"><a href="#class-type-authenticated_transform" class="anchor"></a><code><span><span class="keyword">class</span> <span class="keyword">type</span>  </span><span><a href="class-type-authenticated_transform/index.html">authenticated_transform</a></span><span> = <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-auth_transform_string" class="anchored"><a href="#val-auth_transform_string" class="anchor"></a><code><span><span class="keyword">val</span> auth_transform_string : <span><a href="class-type-authenticated_transform/index.html">authenticated_transform</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>auth_transform_string t s</code> runs the string <code>s</code> through the authenticated transform <code>t</code> and returns the concatenation of the transformed string and its authentication tag. The transform <code>t</code> is wiped before returning, hence can no longer be used for further transformations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-auth_check_transform_string" class="anchored"><a href="#val-auth_check_transform_string" class="anchor"></a><code><span><span class="keyword">val</span> auth_check_transform_string : 
  <span><a href="class-type-authenticated_transform/index.html">authenticated_transform</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string option</span></span></code></div><div class="spec-doc"><p><code>auth_check_transform_string t s</code> splits the string <code>s</code> into an input string <code>s1</code> and an expected authentication tag <code>a</code>. It runs <code>s1</code> through the authenticated transform <code>t</code> and checks that the authentication tag is the expected tag <code>a</code>. If so, the transformed string is returned. If not, <code>None</code> is returned. The input string <code>s</code> must have length greater than or equal to <code>t#tag_size</code>. Otherwise, the <code>Wrong_data_length</code> exception is raised. The transform <code>t</code> is wiped before returning, hence can no longer be used for further transformations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-auth_transform_string_detached" class="anchored"><a href="#val-auth_transform_string_detached" class="anchor"></a><code><span><span class="keyword">val</span> auth_transform_string_detached : 
  <span><a href="class-type-authenticated_transform/index.html">authenticated_transform</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  string * string</span></code></div><div class="spec-doc"><p><code>auth_transform_string_detached t s</code> runs the string <code>s</code> through the authenticated transform <code>t</code> and returns a pair of the transformed string and its authentication tag. The transform <code>t</code> is wiped before returning, hence can no longer be used for further transformations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transform_then_hash" class="anchored"><a href="#val-transform_then_hash" class="anchor"></a><code><span><span class="keyword">val</span> transform_then_hash : <span><a href="class-type-transform/index.html">transform</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="class-type-hash/index.html">hash</a> <span class="arrow">&#45;&gt;</span></span> <a href="class-type-authenticated_transform/index.html">authenticated_transform</a></span></code></div><div class="spec-doc"><p>Build an authenticated transform from a transform <code>t</code> and a hash <code>h</code>. Input data is run through <code>t</code>, producing transformed data. The transformed data is hashed using <code>h</code>. The authentication tag is the final hash value.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transform_and_hash" class="anchored"><a href="#val-transform_and_hash" class="anchor"></a><code><span><span class="keyword">val</span> transform_and_hash : <span><a href="class-type-transform/index.html">transform</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="class-type-hash/index.html">hash</a> <span class="arrow">&#45;&gt;</span></span> <a href="class-type-authenticated_transform/index.html">authenticated_transform</a></span></code></div><div class="spec-doc"><p>Build an authenticated transform from a transform <code>t</code> and a hash <code>h</code>. Input data is run through <code>t</code>, producing transformed data. In parallel, the input data is hashed using <code>h</code>. The authentication tag is the final hash value.</p></div></div><h2 id="utilities:-random-numbers-and-padding-schemes"><a href="#utilities:-random-numbers-and-padding-schemes" class="anchor"></a>Utilities: random numbers and padding schemes</h2><div class="odoc-spec"><div class="spec module" id="module-Random" class="anchored"><a href="#module-Random" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Random/index.html">Random</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Random</code> module provides random and pseudo-random number generators suitable for generating cryptographic keys, nonces, or challenges.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Padding" class="anchored"><a href="#module-Padding" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Padding/index.html">Padding</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Padding</code> module defines a generic interface for padding input data to an integral number of blocks, as well as two popular padding schemes.</p></div></div><h2 id="cryptographic-primitives-(simplified-interface)"><a href="#cryptographic-primitives-(simplified-interface)" class="anchor"></a>Cryptographic primitives (simplified interface)</h2><div class="odoc-spec"><div class="spec module" id="module-Cipher" class="anchored"><a href="#module-Cipher" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Cipher/index.html">Cipher</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Cipher</code> module implements the AES, DES, Triple-DES, ARCfour and Blowfish symmetric ciphers. Symmetric ciphers are presented as transforms parameterized by a secret key and a &quot;direction&quot; indicating whether encryption or decryption is to be performed. The same secret key is used for encryption and for decryption.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-AEAD" class="anchored"><a href="#module-AEAD" class="anchor"></a><code><span><span class="keyword">module</span> <a href="AEAD/index.html">AEAD</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>AEAD</code> module implements authenticated encryption with associated data. This provides the same confidentiality guarantees as plain encryption, but also provides integrity guarantees. This module implements the AES-GCM and Chacha20-Poly1305 algorithms.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Hash" class="anchored"><a href="#module-Hash" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Hash/index.html">Hash</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Hash</code> module implements unkeyed cryptographic hashes (SHA-1, SHA-256, SHA-512, SHA-3, RIPEMD-160 and MD5), also known as message digest functions. Hash functions used in cryptography are characterized as being <i>one-way</i> (given a hash value, it is computationally infeasible to find a text that hashes to this value) and <i>collision-resistant</i> (it is computationally infeasible to find two different texts that hash to the same value). Thus, the hash of a text can be used as a compact replacement for this text for the purposes of ensuring integrity of the text.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-MAC" class="anchored"><a href="#module-MAC" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MAC/index.html">MAC</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>MAC</code> module implements message authentication codes, also known as keyed hash functions. These are hash functions parameterized by a secret key. In addition to being one-way and collision-resistant, a MAC has the property that without knowing the secret key, it is computationally infeasible to find the hash for a known text, even if many pairs of (text, MAC) are known to the attacker. Thus, MAC can be used to authenticate the sender of a text: the receiver of a (text, MAC) pair can recompute the MAC from the text, and if it matches the transmitted MAC, be reasonably certain that the text was authentified by someone who possesses the secret key.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-RSA" class="anchored"><a href="#module-RSA" class="anchor"></a><code><span><span class="keyword">module</span> <a href="RSA/index.html">RSA</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>RSA</code> module implements RSA public-key cryptography. Public-key cryptography is asymmetric: two distinct keys are used for encrypting a message, then decrypting it. Moreover, while one of the keys must remain secret, the other can be made public, since it is computationally very hard to reconstruct the private key from the public key. This feature supports both public-key encryption (anyone can encode with the public key, but only the owner of the private key can decrypt) and digital signature (only the owner of the private key can sign, but anyone can check the signature with the public key).</p></div></div><div class="odoc-spec"><div class="spec module" id="module-DH" class="anchored"><a href="#module-DH" class="anchor"></a><code><span><span class="keyword">module</span> <a href="DH/index.html">DH</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>DH</code> module implements Diffie-Hellman key agreement. Key agreement is a protocol by which two parties can establish a shared secret (typically a key for a symmetric cipher or MAC) by exchanging messages, with the guarantee that even if an attacker eavesdrop on the messages, he cannot recover the shared secret. Diffie-Hellman is one such key agreement protocol, relying on the difficulty of computing discrete logarithms. Notice that the Diffie-Hellman protocol is vulnerable to active attacks (man-in-the-middle attacks).</p></div></div><h2 id="advanced,-compositional-interface-to-block-ciphers-and-stream-ciphers"><a href="#advanced,-compositional-interface-to-block-ciphers-and-stream-ciphers" class="anchor"></a>Advanced, compositional interface to block ciphers and stream ciphers</h2><div class="odoc-spec"><div class="spec module" id="module-Block" class="anchored"><a href="#module-Block" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Block/index.html">Block</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Block</code> module provides classes that implements popular block ciphers, chaining modes, and wrapping of a block cipher as a general transform or as a hash function. The classes can be composed in a Lego-like fashion, facilitating the integration of new block ciphers, modes, etc.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Stream" class="anchored"><a href="#module-Stream" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Stream/index.html">Stream</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Stream</code> module provides classes that implement the ARCfour stream cipher, and the wrapping of a stream cipher as a general transform. The classes can be composed in a Lego-like fashion, facilitating the integration of new stream ciphers.</p></div></div><h2 id="encoding-and-compression-of-data"><a href="#encoding-and-compression-of-data" class="anchor"></a>Encoding and compression of data</h2><div class="odoc-spec"><div class="spec module" id="module-Base64" class="anchored"><a href="#module-Base64" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Base64/index.html">Base64</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Base64</code> module supports the encoding and decoding of binary data in base 64 format, using only alphanumeric characters that can safely be transmitted over e-mail or in URLs.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Hexa" class="anchored"><a href="#module-Hexa" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Hexa/index.html">Hexa</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Hexa</code> module supports the encoding and decoding of binary data as hexadecimal strings. This is a popular format for transmitting keys in textual form.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Zlib" class="anchored"><a href="#module-Zlib" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Zlib/index.html">Zlib</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Zlib</code> module supports the compression and decompression of data, using the <code>zlib</code> library. The algorithm used is Lempel-Ziv compression as in the <code>gzip</code> and <code>zip</code> compressors. While compression itself is not encryption, it is often used prior to encryption to reduce the size of the ciphertext.</p></div></div><h2 id="error-reporting"><a href="#error-reporting" class="anchor"></a>Error reporting</h2><div class="odoc-spec"><div class="spec type" id="type-error" class="anchored"><a href="#type-error" class="anchor"></a><code><span><span class="keyword">type</span> error</span><span> = </span></code><table><tr id="type-error.Wrong_key_size" class="anchored"><td class="def variant constructor"><a href="#type-error.Wrong_key_size" class="anchor"></a><code><span>| </span><span><span class="constructor">Wrong_key_size</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The key is too long or too short for the given cipher.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Wrong_IV_size" class="anchored"><td class="def variant constructor"><a href="#type-error.Wrong_IV_size" class="anchor"></a><code><span>| </span><span><span class="constructor">Wrong_IV_size</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The initialization vector does not have the same size as the block size.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Wrong_data_length" class="anchored"><td class="def variant constructor"><a href="#type-error.Wrong_data_length" class="anchor"></a><code><span>| </span><span><span class="constructor">Wrong_data_length</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The total length of the input data for a transform is not an integral multiple of the input block size.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bad_padding" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_padding" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_padding</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Incorrect padding bytes were found after decryption.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Output_buffer_overflow" class="anchored"><td class="def variant constructor"><a href="#type-error.Output_buffer_overflow" class="anchor"></a><code><span>| </span><span><span class="constructor">Output_buffer_overflow</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The output buffer for a transform exceeds the maximal length of a Caml string.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Incompatible_block_size" class="anchored"><td class="def variant constructor"><a href="#type-error.Incompatible_block_size" class="anchor"></a><code><span>| </span><span><span class="constructor">Incompatible_block_size</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>A combination of two block ciphers was attempted whereby the ciphers have different block sizes, while they must have the same.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Number_too_long" class="anchored"><td class="def variant constructor"><a href="#type-error.Number_too_long" class="anchor"></a><code><span>| </span><span><span class="constructor">Number_too_long</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Denotes an internal error in RSA key generation or encryption.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Seed_too_short" class="anchored"><td class="def variant constructor"><a href="#type-error.Seed_too_short" class="anchor"></a><code><span>| </span><span><span class="constructor">Seed_too_short</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The seed given to a pseudo random number generator is too short.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Message_too_long" class="anchored"><td class="def variant constructor"><a href="#type-error.Message_too_long" class="anchor"></a><code><span>| </span><span><span class="constructor">Message_too_long</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>For symmetric ciphers in counter mode (CTR): the message exceeds the maximal length supported, causing the counter to wrap around. For RSA encryption or decryption: the message is greater than the modulus of the RSA key.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bad_encoding" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_encoding" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_encoding</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Illegal characters were found in an encoding of binary data such as base 64 or hexadecimal.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Compression_error" class="anchored"><td class="def variant constructor"><a href="#type-error.Compression_error" class="anchor"></a><code><span>| </span><span><span class="constructor">Compression_error</span> <span class="keyword">of</span> string * string</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Error during compression or decompression.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.No_entropy_source" class="anchored"><td class="def variant constructor"><a href="#type-error.No_entropy_source" class="anchor"></a><code><span>| </span><span><span class="constructor">No_entropy_source</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>No entropy source (OS, hardware, or <code>/dev/random</code>) was found for <a href="Random/index.html#val-secure_rng"><code>Cryptokit.Random.secure_rng</code></a>.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Entropy_source_closed" class="anchored"><td class="def variant constructor"><a href="#type-error.Entropy_source_closed" class="anchor"></a><code><span>| </span><span><span class="constructor">Entropy_source_closed</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>End of file on a device or EGD entropy source.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Compression_not_supported" class="anchored"><td class="def variant constructor"><a href="#type-error.Compression_not_supported" class="anchor"></a><code><span>| </span><span><span class="constructor">Compression_not_supported</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The data compression functions are not available.</p><span class="comment-delim">*)</span></td></tr></table></div><div class="spec-doc"><p>Error codes for this library.</p></div></div><div class="odoc-spec"><div class="spec exception" id="exception-Error" class="anchored"><a href="#exception-Error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Error</span> <span class="keyword">of</span> <a href="#type-error">error</a></span></code></div><div class="spec-doc"><p>Exception raised by functions in this library to report error conditions.</p></div></div><h2 id="miscellaneous-utilities"><a href="#miscellaneous-utilities" class="anchor"></a>Miscellaneous utilities</h2><div class="odoc-spec"><div class="spec value" id="val-wipe_bytes" class="anchored"><a href="#val-wipe_bytes" class="anchor"></a><code><span><span class="keyword">val</span> wipe_bytes : <span>bytes <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>wipe_bytes b</code> overwrites <code>b</code> with zeroes. Can be used to reduce the memory lifetime of sensitive data.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wipe_string" class="anchored"><a href="#val-wipe_string" class="anchor"></a><code><span><span class="keyword">val</span> wipe_string : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>wipe_string s</code> overwrites <code>s</code> with zeroes. Can be used to reduce the memory lifetime of sensitive data. Note that strings are normally immutable and this operation violates this immutability property. Therefore, this is an unsafe operation, and it should be used only by code that is the only owner of the string <code>s</code>. See <code>Stdlib</code>.Bytes.unsafe_of_string for more details on the ownership policy.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_equal" class="anchored"><a href="#val-string_equal" class="anchor"></a><code><span><span class="keyword">val</span> string_equal : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Constant-time comparison between strings. <code>string_equal s1 s2</code> returns <code>true</code> if the strings <code>s1</code> and <code>s2</code> have the same length and contain the same characters. The execution time of this function is determined by the lengths of <code>s1</code> and <code>s2</code>, but is independent of their contents.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bytes_equal" class="anchored"><a href="#val-bytes_equal" class="anchor"></a><code><span><span class="keyword">val</span> bytes_equal : <span>bytes <span class="arrow">&#45;&gt;</span></span> <span>bytes <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Constant-time comparison between byte sequences. Like <a href="#val-string_equal"><code>Cryptokit.string_equal</code></a>, but for byte sequences.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-xor_bytes" class="anchored"><a href="#val-xor_bytes" class="anchor"></a><code><span><span class="keyword">val</span> xor_bytes : <span>bytes <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>bytes <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>xor_bytes src spos dst dpos len</code> performs the xor (exclusive or) of characters <code>spos, ..., spos + len - 1</code> of <code>src</code> with characters <code>dpos, ..., dpos + len - 1</code> of <code>dst</code>, storing the result in <code>dst</code> starting at position <code>dpos</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-xor_string" class="anchored"><a href="#val-xor_string" class="anchor"></a><code><span><span class="keyword">val</span> xor_string : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>bytes <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Same as <code>xor_bytes</code>, but the source is a string instead of a byte array.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-mod_power" class="anchored"><a href="#val-mod_power" class="anchor"></a><code><span><span class="keyword">val</span> mod_power : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>mod_power a b c</code> computes <code>a^b mod c</code>, where the strings <code>a</code>, <code>b</code>, <code>c</code> and the result are viewed as arbitrary-precision integers in big-endian format. Requires <code>a &lt; c</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-mod_mult" class="anchored"><a href="#val-mod_mult" class="anchor"></a><code><span><span class="keyword">val</span> mod_mult : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>mod_mult a b c</code> computes <code>a*b mod c</code>, where the strings <code>a</code>, <code>b</code>, <code>c</code> and the result are viewed as arbitrary-precision integers in big-endian format.</p></div></div></div></body></html>